[build]
  # Directory to change to before starting a build.
  # This is where we will look for package.json/.nvmrc/etc.
  # Set to root directory of the repository (where package.json is located)
  base = ""

  # Directory (relative to root of your repo) that contains the deploy-ready
  # HTML files and assets generated by the build. This is relative to the base
  # directory if one has been set, or the root directory if a base has not been set.
  publish = "dist"

  # Default build command.
  command = "npm run build"

  # Functions directory - where Netlify serverless functions are stored
  functions = "netlify/functions"

# Production context: all deploys from the Production branch set in your site's
# deploy settings will inherit these settings.
[context.production.environment]
  NODE_VERSION = "18"

# Deploy Preview context: all deploys generated from
# a pull/merge request will inherit these settings.
[context.deploy-preview.environment]
  NODE_VERSION = "18"

# Branch Deploy context: all deploys that are not from
# a pull/merge request or from the Production branch will inherit these settings.
[context.branch-deploy.environment]
  NODE_VERSION = "18"

# Redirects and rewrites

# 404 page for common attack vectors
[[redirects]]
  from = "/*.php"
  to = "/404.html"
  status = 404

[[redirects]]
  from = "/*.asp"
  to = "/404.html"
  status = 404

[[redirects]]
  from = "/wp-admin/*"
  to = "/404.html"
  status = 404

[[redirects]]
  from = "/api/*"
  to = "/404.html"
  status = 404

# Admin redirect
[[redirects]]
  from = "/admin"
  to = "/admin/"
  status = 301

# SPA fallback - this will NOT interfere with /admin/ because static files are served first
[[redirects]]
  from = "/*"
  to = "/index.html"
  status = 200

# Headers for static files
[[headers]]
  for = "*.js"
  [headers.values]
    Cache-Control = "public, max-age=604800"

[[headers]]
  for = "*.css"
  [headers.values]
    Cache-Control = "public, max-age=604800"

[[headers]]
  for = "*.png"
  [headers.values]
    Cache-Control = "public, max-age=2592000"

[[headers]]
  for = "*.jpg"
  [headers.values]
    Cache-Control = "public, max-age=2592000"

[[headers]]
  for = "*.jpeg"
  [headers.values]
    Cache-Control = "public, max-age=2592000"